/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.9.2
 * 编译日期：2025-03-07 17:59
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：北京鼎新云科技发展有限公司 ，2025-03-07
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x466792=_0x42de;(function(_0x2cbca7,_0x2ea004){var _0x238f15={_0x45bf1a:0x17d,_0x1b2984:0x18f,_0x3c9f73:0x1ff,_0x1dc62f:0x1e5},_0x248e87=_0x42de,_0x47bb9d=_0x2cbca7();while(!![]){try{var _0x38550e=parseInt(_0x248e87(0x1c1))/0x1+parseInt(_0x248e87(0x205))/0x2*(-parseInt(_0x248e87(0x1ed))/0x3)+parseInt(_0x248e87(0x1ec))/0x4*(-parseInt(_0x248e87(0x1c2))/0x5)+parseInt(_0x248e87(_0x238f15._0x45bf1a))/0x6+parseInt(_0x248e87(_0x238f15._0x1b2984))/0x7*(parseInt(_0x248e87(_0x238f15._0x3c9f73))/0x8)+-parseInt(_0x248e87(_0x238f15._0x1dc62f))/0x9+-parseInt(_0x248e87(0x18c))/0xa*(-parseInt(_0x248e87(0x1dd))/0xb);if(_0x38550e===_0x2ea004)break;else _0x47bb9d['push'](_0x47bb9d['shift']());}catch(_0x596814){_0x47bb9d['push'](_0x47bb9d['shift']());}}}(_0x90dc,0x37e84));function _0x90dc(){var _0x5ec7a5=['xmax','_store','_min','show','fillStyle','_clear','min','position','style','ctx','setDataMin','_config','extremachange','_max','KEEP','formatRectangle','canvas','get','_graphic2','cStore','radi','getContext','_bounds','cssText','value','forEach','_renderer','removeGraphic','options','_getArcHeatCanvas','updateRadius','shadowCtx','_maxOpacity','drawImage','useGradientOpacity','setDataMax','heat','renderall','37207Ukyytk','25AFODjn','uniforms','length','image/png','clientHeight','_updateGradient','_blur','emit','minOpacity','gradient','_templates','_setStyles','_opacity','_heat','Rectangle','toDataURL','_data','setData','layer','_coordinator','_createArcGraphic','height','addColorStop','Cartesian2','arcDirection','lng','defineProperty','5388911TVxDRU','positions','EPSG:3857','yellow','_palette','renderpartial','rgb(0,255,0)','shadowCanvas','2359161HBTvBv','getDataURL','addLayer','RenderState','push','getImageData','chordLength','204860sRGBSi','18EayvCm','_rectangle','addPosition','defaultMaxOpacity','rgb(0,0,0)','_layer','redrawRatio','Plugin\x20\x27','getValueAt','__esModule','floor','_graphic','ymin','points','blur','_cfgRadius','getOwnPropertyDescriptor','_map','1070224mSjqij','undefined','clear','width','rectangle','diffY','73690ODXNme','getRectangle','ellipsoid','rgb(0,0,255)','ALPHA_BLEND','diffX','_renderBoundaries','prototype','radius','Image2','width:','_getInternalData','_onExtremaChange','max','arc','globalAlpha','_valueField','rgb(255,255,255)','Material','heatStyle','addData','_width','exports','_positions','pickEllipsoid','ymax','LngLatPoint','create','238968LyPfll','data','lat','_updateGraphic','valueField','apply','store','_showHook','EllipsoidSurfaceAppearance','RectanglePrimitive','Util','formatNum','diffHeight','rgb(216,216,216)','_minOpacity','10DNDCaO','_onCameraMoveEnd','equals','21hSPuWz','getData','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','keys','rgb(140,140,140)','isArray','REPLACE','createLinearGradient','Math','appendChild','renderAll','createElement'];_0x90dc=function(){return _0x5ec7a5;};return _0x90dc();}function _interopNamespace(_0x2820f6){var _0x23f311={_0x25ce1:0x192},_0x53d92b=_0x42de;if(_0x2820f6&&_0x2820f6[_0x53d92b(0x1f6)])return _0x2820f6;var _0x55e590=Object[_0x53d92b(0x17c)](null);return _0x2820f6&&Object[_0x53d92b(_0x23f311._0x25ce1)](_0x2820f6)['forEach'](function(_0x17e9b2){var _0x37c213=_0x53d92b;if(_0x17e9b2!=='default'){var _0x487d3e=Object['getOwnPropertyDescriptor'](_0x2820f6,_0x17e9b2);Object[_0x37c213(0x1dc)](_0x55e590,_0x17e9b2,_0x487d3e['get']?_0x487d3e:{'enumerable':!![],'get':function(){return _0x2820f6[_0x17e9b2];}});}}),_0x55e590['default']=_0x2820f6,_0x55e590;}function _mergeNamespaces(_0x775881,_0x42d95c){var _0x5b50b7={_0x57607f:0x194,_0x5a28dd:0x192},_0xa2ac25={_0x43c96c:0x1fd};return _0x42d95c['forEach'](function(_0x404407){var _0x3c4e34=_0x42de;_0x404407&&typeof _0x404407!=='string'&&!Array[_0x3c4e34(_0x5b50b7._0x57607f)](_0x404407)&&Object[_0x3c4e34(_0x5b50b7._0x5a28dd)](_0x404407)['forEach'](function(_0xb65272){var _0x57cd56=_0x3c4e34;if(_0xb65272!=='default'&&!(_0xb65272 in _0x775881)){var _0x59c755=Object[_0x57cd56(_0xa2ac25._0x43c96c)](_0x404407,_0xb65272);Object['defineProperty'](_0x775881,_0xb65272,_0x59c755[_0x57cd56(0x1ac)]?_0x59c755:{'enumerable':!![],'get':function(){return _0x404407[_0xb65272];}});}});}),_0x775881;}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!==_0x466792(0x200)?globalThis:typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{},heatmap$1={'exports':{}};function _0x42de(_0x439f60,_0x30e4d0){var _0x90dc2c=_0x90dc();return _0x42de=function(_0x42dea0,_0x199f76){_0x42dea0=_0x42dea0-0x171;var _0x6f9dc0=_0x90dc2c[_0x42dea0];return _0x6f9dc0;},_0x42de(_0x439f60,_0x30e4d0);}(function(_0x49556e){var _0xeb0df9={_0xf3fa65:0x208,_0x252112:0x1e3},_0x5c04f9={_0x58cd70:0x20c},_0x21c67a={_0x2d57ed:0x177};(function(_0x392376,_0x2fb4be,_0x439b71){var _0x410809=_0x42de;_0x49556e['exports']?_0x49556e[_0x410809(_0x21c67a._0x2d57ed)]=_0x439b71():_0x2fb4be[_0x392376]=_0x439b71();}('h337',commonjsGlobal,function(){var _0x2a2e64={_0x127583:0x1f4},_0x32fb16={_0xc556e5:0x1a8},_0x5b9115={_0x564d45:0x1c4,_0x210d32:0x1b3,_0xc5e3c2:0x1cc,_0x529a5f:0x1cc,_0x1b5785:0x20b,_0x3820bf:0x20b},_0x1d11f6={_0x1e13ca:0x1fb,_0x3598bb:0x202,_0x41e45e:0x1d7,_0x1f5aff:0x1ce,_0x4b1628:0x1bb,_0x27fefe:0x1ca},_0x3982e9={_0x4d47b2:0x202,_0x154f0b:0x1e4},_0x4b1692={_0x54fb9f:0x202,_0x34abb0:0x1ba,_0x59bbb1:0x1b0,_0x450a96:0x1b2,_0xe3c30b:0x1a2,_0x374d8f:0x1cd},_0x78a3f3={_0x582aaf:0x210},_0x29cca6={_0x445e20:0x211,_0x6d2ba3:0x210},_0x402313={_0x5822c3:0x1c9},_0x4de3d0={_0x2a7ebd:0x1a8},_0x130135=_0x42de,_0x5cfdd2={'defaultRadius':0x28,'defaultRenderer':'canvas2d','defaultGradient':{0.25:_0x130135(_0xeb0df9._0xf3fa65),0.55:_0x130135(_0xeb0df9._0x252112),0.85:_0x130135(0x1e0),0x1:'rgb(255,0,0)'},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':_0x130135(0x1b3),'plugins':{}},_0x44ab6e=function _0x5387e4(){var _0x663e4c={_0x5cf738:0x175},_0x35d590={_0x2106b6:0x19d,_0x18ddce:0x171,_0x9ac2d0:0x1be,_0x11d351:0x1a5},_0x3162ca=_0x130135,_0x35762e=function _0x5e486c(_0x373499){var _0x47d276=_0x42de;this['_coordinator']={},this['_data']=[],this['_radi']=[],this[_0x47d276(0x19d)]=0xa,this['_max']=0x1,this['_xField']=_0x373499['xField']||_0x373499['defaultXField'],this['_yField']=_0x373499['yField']||_0x373499['defaultYField'],this['_valueField']=_0x373499[_0x47d276(0x181)]||_0x373499['defaultValueField'],_0x373499['radius']&&(this[_0x47d276(0x1fc)]=_0x373499['radius']);},_0x1c2609=_0x5cfdd2['defaultRadius'];return _0x35762e[_0x3162ca(_0x5c04f9._0x58cd70)]={'_organiseData':function(_0x38456b,_0x55f053){var _0x11b74a=_0x3162ca,_0x51111e=_0x38456b[this['_xField']],_0x564b6e=_0x38456b[this['_yField']],_0x316694=this['_radi'],_0x4765c0=this['_data'],_0xfd9446=this['_max'],_0x168986=this[_0x11b74a(_0x35d590._0x2106b6)],_0x134781=_0x38456b[this[_0x11b74a(_0x35d590._0x18ddce)]]||0x1,_0x594dc8=_0x38456b['radius']||this['_cfgRadius']||_0x1c2609;!_0x4765c0[_0x51111e]&&(_0x4765c0[_0x51111e]=[],_0x316694[_0x51111e]=[]);!_0x4765c0[_0x51111e][_0x564b6e]?(_0x4765c0[_0x51111e][_0x564b6e]=_0x134781,_0x316694[_0x51111e][_0x564b6e]=_0x594dc8):_0x4765c0[_0x51111e][_0x564b6e]+=_0x134781;var _0x5e5ecb=_0x4765c0[_0x51111e][_0x564b6e];if(_0x5e5ecb>_0xfd9446)return!_0x55f053?this['_max']=_0x5e5ecb:this[_0x11b74a(_0x35d590._0x9ac2d0)](_0x5e5ecb),![];else return _0x5e5ecb<_0x168986?(!_0x55f053?this[_0x11b74a(0x19d)]=_0x5e5ecb:this[_0x11b74a(_0x35d590._0x11d351)](_0x5e5ecb),![]):{'x':_0x51111e,'y':_0x564b6e,'value':_0x134781,'radius':_0x594dc8,'min':_0x168986,'max':_0xfd9446};},'_unOrganizeData':function(){var _0x5480c2=_0x3162ca,_0xd61c8f=[],_0x1af0ff=this['_data'],_0x56d29f=this['_radi'];for(var _0x207c74 in _0x1af0ff){for(var _0x4c3f71 in _0x1af0ff[_0x207c74]){_0xd61c8f[_0x5480c2(0x1e9)]({'x':_0x207c74,'y':_0x4c3f71,'radius':_0x56d29f[_0x207c74][_0x4c3f71],'value':_0x1af0ff[_0x207c74][_0x4c3f71]});}}return{'min':this['_min'],'max':this[_0x5480c2(_0x4de3d0._0x2a7ebd)],'data':_0xd61c8f};},'_onExtremaChange':function(){var _0xf60cbd=_0x3162ca;this['_coordinator'][_0xf60cbd(_0x402313._0x5822c3)]('extremachange',{'min':this['_min'],'max':this['_max']});},'addData':function(){var _0x821dc6=_0x3162ca;if(arguments[0x0]['length']>0x0){var _0x267319=arguments[0x0],_0x326b8d=_0x267319['length'];while(_0x326b8d--){this[_0x821dc6(_0x663e4c._0x5cf738)]['call'](this,_0x267319[_0x326b8d]);}}else{var _0x2d9152=this['_organiseData'](arguments[0x0],!![]);_0x2d9152&&(this['_data'][_0x821dc6(0x1c4)]===0x0&&(this['_min']=this['_max']=_0x2d9152['value']),this['_coordinator']['emit']('renderpartial',{'min':this['_min'],'max':this['_max'],'data':[_0x2d9152]}));}return this;},'setData':function(_0x4f0c67){var _0x44966a=_0x3162ca,_0x137dcb=_0x4f0c67[_0x44966a(0x17e)],_0x9125c0=_0x137dcb['length'];this[_0x44966a(0x1d2)]=[],this['_radi']=[];for(var _0x871a33=0x0;_0x871a33<_0x9125c0;_0x871a33++){this['_organiseData'](_0x137dcb[_0x871a33],![]);}return this[_0x44966a(0x1a8)]=_0x4f0c67['max'],this['_min']=_0x4f0c67['min']||0x0,this[_0x44966a(_0x29cca6._0x445e20)](),this['_coordinator']['emit']('renderall',this[_0x44966a(_0x29cca6._0x6d2ba3)]()),this;},'removeData':function(){},'setDataMax':function(_0x39773c){return this['_max']=_0x39773c,this['_onExtremaChange'](),this['_coordinator']['emit']('renderall',this['_getInternalData']()),this;},'setDataMin':function(_0x47aac0){var _0x550940=_0x3162ca;return this[_0x550940(0x19d)]=_0x47aac0,this['_onExtremaChange'](),this['_coordinator'][_0x550940(0x1c9)]('renderall',this[_0x550940(_0x78a3f3._0x582aaf)]()),this;},'setCoordinator':function(_0x593350){var _0x20efff=_0x3162ca;this[_0x20efff(0x1d5)]=_0x593350;},'_getInternalData':function(){var _0xd4a085=_0x3162ca;return{'max':this['_max'],'min':this['_min'],'data':this[_0xd4a085(0x1d2)],'radi':this['_radi']};},'getData':function(){return this['_unOrganizeData']();}},_0x35762e;}(),_0x10a252=function _0x2d9ed9(){var _0x1fb4a6={_0x2c3028:0x1e1},_0x276633={_0x5ec2bb:0x19f,_0x8ffe49:0x19f},_0x485703={_0x2890dc:0x1d7,_0x1a33f7:0x196},_0x5b76f9=function(_0x55bb9c){var _0x4ab374=_0x42de,_0x5e9952=_0x55bb9c['gradient']||_0x55bb9c['defaultGradient'],_0x23efa2=document['createElement']('canvas'),_0x4dd633=_0x23efa2['getContext']('2d',{'willReadFrequently':!![]});_0x23efa2['width']=0x100,_0x23efa2[_0x4ab374(_0x485703._0x2890dc)]=0x1;var _0xba3775=_0x4dd633[_0x4ab374(_0x485703._0x1a33f7)](0x0,0x0,0x100,0x1);for(var _0x1ebbcb in _0x5e9952){_0xba3775[_0x4ab374(0x1d8)](_0x1ebbcb,_0x5e9952[_0x1ebbcb]);}return _0x4dd633[_0x4ab374(0x19f)]=_0xba3775,_0x4dd633['fillRect'](0x0,0x0,0x100,0x1),_0x4dd633['getImageData'](0x0,0x0,0x100,0x1)['data'];},_0x115074=function(_0xb2e965,_0x214b48){var _0x48435c=_0x42de,_0x1f8032=document[_0x48435c(0x19a)]('canvas'),_0x55961a=_0x1f8032['getContext']('2d',{'willReadFrequently':!![]}),_0x3660c2=_0xb2e965,_0x2120f1=_0xb2e965;_0x1f8032['width']=_0x1f8032['height']=_0xb2e965*0x2;if(_0x214b48==0x1)_0x55961a['beginPath'](),_0x55961a['arc'](_0x3660c2,_0x2120f1,_0xb2e965,0x0,0x2*Math['PI'],![]),_0x55961a[_0x48435c(_0x276633._0x5ec2bb)]='rgba(0,0,0,1)',_0x55961a['fill']();else{var _0x552a40=_0x55961a['createRadialGradient'](_0x3660c2,_0x2120f1,_0xb2e965*_0x214b48,_0x3660c2,_0x2120f1,_0xb2e965);_0x552a40['addColorStop'](0x0,'rgba(0,0,0,1)'),_0x552a40['addColorStop'](0x1,'rgba(0,0,0,0)'),_0x55961a[_0x48435c(_0x276633._0x8ffe49)]=_0x552a40,_0x55961a['fillRect'](0x0,0x0,0x2*_0xb2e965,0x2*_0xb2e965);}return _0x1f8032;},_0x20d9ba=function(_0x27efe6){var _0x5e1503=_0x42de,_0xd242c4=[],_0x4fd68b=_0x27efe6['min'],_0x3de908=_0x27efe6['max'],_0x2a680f=_0x27efe6[_0x5e1503(0x1af)],_0x27efe6=_0x27efe6[_0x5e1503(0x17e)],_0x23c346=Object['keys'](_0x27efe6),_0x16feb8=_0x23c346['length'];while(_0x16feb8--){var _0x1560d3=_0x23c346[_0x16feb8],_0x3c0bd9=Object['keys'](_0x27efe6[_0x1560d3]),_0x3ca7bc=_0x3c0bd9['length'];while(_0x3ca7bc--){var _0x4098c5=_0x3c0bd9[_0x3ca7bc],_0x44a756=_0x27efe6[_0x1560d3][_0x4098c5],_0x15d2a2=_0x2a680f[_0x1560d3][_0x4098c5];_0xd242c4[_0x5e1503(0x1e9)]({'x':_0x1560d3,'y':_0x4098c5,'value':_0x44a756,'radius':_0x15d2a2});}}return{'min':_0x4fd68b,'max':_0x3de908,'data':_0xd242c4};};function _0x56452a(_0x5aadfb){var _0x45dbe4=_0x42de,_0x18749f=_0x5aadfb['container'],_0x39d98a=this[_0x45dbe4(0x1e4)]=document['createElement'](_0x45dbe4(0x1ab)),_0x16f99b=this['canvas']=_0x5aadfb['canvas']||document['createElement']('canvas');this[_0x45dbe4(0x20b)]=[0x2710,0x2710,0x0,0x0];var _0x5dd118=getComputedStyle(_0x5aadfb['container'])||{};_0x16f99b['className']='heatmap-canvas',this['_width']=_0x16f99b['width']=_0x39d98a['width']=_0x5aadfb['width']||+_0x5dd118[_0x45dbe4(_0x4b1692._0x54fb9f)]['replace'](/px/,''),this['_height']=_0x16f99b[_0x45dbe4(0x1d7)]=_0x39d98a['height']=_0x5aadfb['height']||+_0x5dd118[_0x45dbe4(0x1d7)]['replace'](/px/,''),this[_0x45dbe4(_0x4b1692._0x34abb0)]=_0x39d98a['getContext']('2d',{'willReadFrequently':!![]}),this['ctx']=_0x16f99b[_0x45dbe4(_0x4b1692._0x59bbb1)]('2d',{'willReadFrequently':!![]}),_0x16f99b['style']['cssText']=_0x39d98a['style'][_0x45dbe4(_0x4b1692._0x450a96)]='position:absolute;left:0;top:0;',_0x18749f['style'][_0x45dbe4(_0x4b1692._0xe3c30b)]='relative',_0x18749f[_0x45dbe4(0x198)](_0x16f99b),this['_palette']=_0x5b76f9(_0x5aadfb),this['_templates']={},this[_0x45dbe4(_0x4b1692._0x374d8f)](_0x5aadfb);}return _0x56452a['prototype']={'renderPartial':function(_0x1ea25a){_0x1ea25a['data']['length']>0x0&&(this['_drawAlpha'](_0x1ea25a),this['_colorize']());},'renderAll':function(_0x44828e){var _0x3f7b64=_0x42de;this[_0x3f7b64(0x1a0)](),_0x44828e[_0x3f7b64(0x17e)]['length']>0x0&&(this['_drawAlpha'](_0x20d9ba(_0x44828e)),this['_colorize']());},'_updateGradient':function(_0x216b62){var _0x1a48f6=_0x42de;this[_0x1a48f6(_0x1fb4a6._0x2c3028)]=_0x5b76f9(_0x216b62);},'updateConfig':function(_0x54d807){var _0x52c899=_0x42de;_0x54d807[_0x52c899(0x1cb)]&&this[_0x52c899(0x1c7)](_0x54d807),this['_setStyles'](_0x54d807);},'setDimensions':function(_0x186377,_0x54f2bd){var _0x128b08=_0x42de;this['_width']=_0x186377,this['_height']=_0x54f2bd,this[_0x128b08(0x1ab)]['width']=this[_0x128b08(0x1e4)][_0x128b08(_0x3982e9._0x4d47b2)]=_0x186377,this['canvas']['height']=this[_0x128b08(_0x3982e9._0x154f0b)][_0x128b08(0x1d7)]=_0x54f2bd;},'_clear':function(){var _0xc92cd6=_0x42de;this['shadowCtx']['clearRect'](0x0,0x0,this[_0xc92cd6(0x176)],this['_height']),this['ctx']['clearRect'](0x0,0x0,this['_width'],this['_height']);},'_setStyles':function(_0x278897){var _0x5c8ddf=_0x42de;this[_0x5c8ddf(0x1c8)]=_0x278897['blur']==0x0?0x0:_0x278897[_0x5c8ddf(_0x1d11f6._0x1e13ca)]||_0x278897['defaultBlur'],_0x278897['backgroundColor']&&(this[_0x5c8ddf(0x1ab)]['style']['backgroundColor']=_0x278897['backgroundColor']),this['_width']=this['canvas']['width']=this['shadowCanvas'][_0x5c8ddf(0x202)]=_0x278897[_0x5c8ddf(_0x1d11f6._0x3598bb)]||this['_width'],this['_height']=this['canvas']['height']=this[_0x5c8ddf(0x1e4)][_0x5c8ddf(_0x1d11f6._0x41e45e)]=_0x278897[_0x5c8ddf(0x1d7)]||this['_height'],this[_0x5c8ddf(_0x1d11f6._0x1f5aff)]=(_0x278897['opacity']||0x0)*0xff,this[_0x5c8ddf(_0x1d11f6._0x4b1628)]=(_0x278897['maxOpacity']||_0x278897[_0x5c8ddf(0x1f0)])*0xff,this['_minOpacity']=(_0x278897[_0x5c8ddf(_0x1d11f6._0x27fefe)]||_0x278897['defaultMinOpacity'])*0xff,this['_useGradientOpacity']=!!_0x278897[_0x5c8ddf(0x1bd)];},'_drawAlpha':function(_0x3f0435){var _0xd8f306=_0x42de,_0x4d9a83=this['_min']=_0x3f0435['min'],_0x21116b=this['_max']=_0x3f0435['max'],_0x3f0435=_0x3f0435['data']||[],_0x21a8e6=_0x3f0435[_0xd8f306(_0x5b9115._0x564d45)],_0x27b20c=0x1-this[_0xd8f306(0x1c8)];while(_0x21a8e6--){var _0x1b7992=_0x3f0435[_0x21a8e6],_0x325ec4=_0x1b7992['x'],_0x608577=_0x1b7992['y'],_0x19eb7d=_0x1b7992['radius'],_0x39141f=Math['min'](_0x1b7992[_0xd8f306(_0x5b9115._0x210d32)],_0x21116b),_0x4b6bc4=_0x325ec4-_0x19eb7d,_0x10efbc=_0x608577-_0x19eb7d,_0x235ea8=this['shadowCtx'],_0x25aa8d;!this[_0xd8f306(_0x5b9115._0xc5e3c2)][_0x19eb7d]?this[_0xd8f306(_0x5b9115._0x529a5f)][_0x19eb7d]=_0x25aa8d=_0x115074(_0x19eb7d,_0x27b20c):_0x25aa8d=this[_0xd8f306(_0x5b9115._0x529a5f)][_0x19eb7d];var _0x4cce1a=(_0x39141f-_0x4d9a83)/(_0x21116b-_0x4d9a83);_0x235ea8[_0xd8f306(0x214)]=_0x4cce1a<0.01?0.01:_0x4cce1a,_0x235ea8[_0xd8f306(0x1bc)](_0x25aa8d,_0x4b6bc4,_0x10efbc),_0x4b6bc4<this[_0xd8f306(_0x5b9115._0x1b5785)][0x0]&&(this['_renderBoundaries'][0x0]=_0x4b6bc4),_0x10efbc<this[_0xd8f306(0x20b)][0x1]&&(this[_0xd8f306(_0x5b9115._0x3820bf)][0x1]=_0x10efbc),_0x4b6bc4+0x2*_0x19eb7d>this['_renderBoundaries'][0x2]&&(this['_renderBoundaries'][0x2]=_0x4b6bc4+0x2*_0x19eb7d),_0x10efbc+0x2*_0x19eb7d>this['_renderBoundaries'][0x3]&&(this[_0xd8f306(0x20b)][0x3]=_0x10efbc+0x2*_0x19eb7d);}},'_colorize':function(){var _0x4b44f1=_0x42de,_0x58edbc=this['_renderBoundaries'][0x0],_0x13acf9=this[_0x4b44f1(0x20b)][0x1],_0x5173d4=this['_renderBoundaries'][0x2]-_0x58edbc,_0x578a1f=this['_renderBoundaries'][0x3]-_0x13acf9,_0x121f81=this['_width'],_0x1c9fc3=this['_height'],_0x67182f=this['_opacity'],_0x5e3657=this['_maxOpacity'],_0x396823=this[_0x4b44f1(0x18b)],_0x45cc44=this['_useGradientOpacity'];_0x58edbc<0x0&&(_0x58edbc=0x0);_0x13acf9<0x0&&(_0x13acf9=0x0);_0x58edbc+_0x5173d4>_0x121f81&&(_0x5173d4=_0x121f81-_0x58edbc);_0x13acf9+_0x578a1f>_0x1c9fc3&&(_0x578a1f=_0x1c9fc3-_0x13acf9);var _0x41c8d2=this['shadowCtx'][_0x4b44f1(0x1ea)](_0x58edbc,_0x13acf9,_0x5173d4,_0x578a1f),_0x82fe00=_0x41c8d2['data'],_0x28c6d6=_0x82fe00['length'],_0x2b9077=this['_palette'];for(var _0xb1f07d=0x3;_0xb1f07d<_0x28c6d6;_0xb1f07d+=0x4){var _0x4ab061=_0x82fe00[_0xb1f07d],_0x2fe1dd=_0x4ab061*0x4;if(!_0x2fe1dd)continue;var _0x14611e;_0x67182f>0x0?_0x14611e=_0x67182f:_0x4ab061<_0x5e3657?_0x4ab061<_0x396823?_0x14611e=_0x396823:_0x14611e=_0x4ab061:_0x14611e=_0x5e3657,_0x82fe00[_0xb1f07d-0x3]=_0x2b9077[_0x2fe1dd],_0x82fe00[_0xb1f07d-0x2]=_0x2b9077[_0x2fe1dd+0x1],_0x82fe00[_0xb1f07d-0x1]=_0x2b9077[_0x2fe1dd+0x2],_0x82fe00[_0xb1f07d]=_0x45cc44?_0x2b9077[_0x2fe1dd+0x3]:_0x14611e;}this['ctx']['putImageData'](_0x41c8d2,_0x58edbc,_0x13acf9),this['_renderBoundaries']=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x2ba2a9){var _0x33723a=_0x42de,_0x304852,_0x6bcbc7=this[_0x33723a(0x1ba)],_0x3ee164=_0x6bcbc7['getImageData'](_0x2ba2a9['x'],_0x2ba2a9['y'],0x1,0x1),_0x44bed2=_0x3ee164['data'][0x3],_0x489285=this[_0x33723a(_0x32fb16._0xc556e5)],_0x2bfddf=this['_min'];return _0x304852=Math['abs'](_0x489285-_0x2bfddf)*(_0x44bed2/0xff)>>0x0,_0x304852;},'getDataURL':function(){return this['canvas']['toDataURL']();}},_0x56452a;}(),_0x471d3f=function _0x570176(){var _0x4c9609=![];return _0x5cfdd2['defaultRenderer']==='canvas2d'&&(_0x4c9609=_0x10a252),_0x4c9609;}(),_0x2cc3e9={'merge':function(){var _0x43470b={},_0x47a557=arguments['length'];for(var _0x5f2601=0x0;_0x5f2601<_0x47a557;_0x5f2601++){var _0x460a19=arguments[_0x5f2601];for(var _0x3114fc in _0x460a19){_0x43470b[_0x3114fc]=_0x460a19[_0x3114fc];}}return _0x43470b;}},_0x90f9bb=function _0x303458(){var _0x5e0c50={_0x165d60:0x19c},_0x71ef78={_0x17bb28:0x190},_0x239086={_0x419b68:0x210},_0x8451a5={_0x35ade3:0x182},_0x2cb19c={_0x229423:0x19c},_0x2b0e85={_0x306a4a:0x19c},_0x417606={_0x35baae:0x1e2,_0x159bb1:0x199,_0x235c43:0x1a7},_0x4dcecd=function _0x3c20d8(){var _0x153283={_0x3abb57:0x1ae};function _0xd86e8a(){this['cStore']={};}return _0xd86e8a['prototype']={'on':function(_0x26c46e,_0x580cec,_0x195336){var _0x51b955=_0x42de,_0x30789d=this[_0x51b955(_0x153283._0x3abb57)];!_0x30789d[_0x26c46e]&&(_0x30789d[_0x26c46e]=[]),_0x30789d[_0x26c46e]['push'](function(_0x32a7d3){return _0x580cec['call'](_0x195336,_0x32a7d3);});},'emit':function(_0x5a28c5,_0x453887){var _0xa8fea8=this['cStore'];if(_0xa8fea8[_0x5a28c5]){var _0x282443=_0xa8fea8[_0x5a28c5]['length'];for(var _0xb4dc80=0x0;_0xb4dc80<_0x282443;_0xb4dc80++){var _0x13c8a5=_0xa8fea8[_0x5a28c5][_0xb4dc80];_0x13c8a5(_0x453887);}}}},_0xd86e8a;}(),_0x3f49f2=function(_0x389c2a){var _0x2ff40e={_0x461ebf:0x1a6},_0x3e71ef=_0x42de,_0x241245=_0x389c2a['_renderer'],_0x1b0fc0=_0x389c2a['_coordinator'],_0x5df000=_0x389c2a['_store'];_0x1b0fc0['on'](_0x3e71ef(_0x417606._0x35baae),_0x241245['renderPartial'],_0x241245),_0x1b0fc0['on']('renderall',_0x241245[_0x3e71ef(_0x417606._0x159bb1)],_0x241245),_0x1b0fc0['on'](_0x3e71ef(_0x417606._0x235c43),function(_0x176d04){var _0x5df6bc=_0x3e71ef;_0x389c2a['_config']['onExtremaChange']&&_0x389c2a[_0x5df6bc(0x1a6)]['onExtremaChange']({'min':_0x176d04['min'],'max':_0x176d04['max'],'gradient':_0x389c2a[_0x5df6bc(_0x2ff40e._0x461ebf)]['gradient']||_0x389c2a['_config']['defaultGradient']});}),_0x5df000['setCoordinator'](_0x1b0fc0);};function _0xfd74e7(){var _0x26ff03=_0x42de,_0x4e4953=this['_config']=_0x2cc3e9['merge'](_0x5cfdd2,arguments[0x0]||{});this['_coordinator']=new _0x4dcecd();if(_0x4e4953['plugin']){var _0x2f78d9=_0x4e4953['plugin'];if(!_0x5cfdd2['plugins'][_0x2f78d9])throw new Error(_0x26ff03(_0x2a2e64._0x127583)+_0x2f78d9+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x586297=_0x5cfdd2['plugins'][_0x2f78d9];this['_renderer']=new _0x586297['renderer'](_0x4e4953),this['_store']=new _0x586297[(_0x26ff03(0x183))](_0x4e4953);}}else this['_renderer']=new _0x471d3f(_0x4e4953),this['_store']=new _0x44ab6e(_0x4e4953);_0x3f49f2(this);}return _0xfd74e7['prototype']={'addData':function(){return this['_store']['addData']['apply'](this['_store'],arguments),this;},'removeData':function(){var _0xdf39c9=_0x42de;return this[_0xdf39c9(_0x2b0e85._0x306a4a)]['removeData']&&this['_store']['removeData'][_0xdf39c9(0x182)](this['_store'],arguments),this;},'setData':function(){var _0x57c0cd=_0x42de;return this[_0x57c0cd(_0x2cb19c._0x229423)]['setData']['apply'](this['_store'],arguments),this;},'setDataMax':function(){var _0x7fa189=_0x42de;return this['_store']['setDataMax'][_0x7fa189(_0x8451a5._0x35ade3)](this['_store'],arguments),this;},'setDataMin':function(){var _0x9f5421=_0x42de;return this['_store']['setDataMin'][_0x9f5421(0x182)](this['_store'],arguments),this;},'configure':function(_0x124d4e){var _0x21058b=_0x42de;return this['_config']=_0x2cc3e9['merge'](this['_config'],_0x124d4e),this['_renderer']['updateConfig'](this['_config']),this['_coordinator']['emit']('renderall',this['_store'][_0x21058b(_0x239086._0x419b68)]()),this;},'repaint':function(){var _0x240993=_0x42de;return this[_0x240993(0x1d5)]['emit'](_0x240993(0x1c0),this['_store']['_getInternalData']()),this;},'getData':function(){var _0x4275ee=_0x42de;return this['_store'][_0x4275ee(_0x71ef78._0x17bb28)]();},'getDataURL':function(){var _0x3cf5d0=_0x42de;return this['_renderer'][_0x3cf5d0(0x1e6)]();},'getValueAt':function(_0x59975d){var _0x375a88=_0x42de;if(this[_0x375a88(_0x5e0c50._0x165d60)][_0x375a88(0x1f5)])return this['_store']['getValueAt'](_0x59975d);else return this['_renderer']['getValueAt']?this['_renderer']['getValueAt'](_0x59975d):null;}},_0xfd74e7;}(),_0x1c0182={'create':function(_0x399770){return new _0x90f9bb(_0x399770);},'register':function(_0x5cba19,_0x3c8968){_0x5cfdd2['plugins'][_0x5cba19]=_0x3c8968;}};return _0x1c0182;}));}(heatmap$1));var heatmap=heatmap$1[_0x466792(0x177)],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial=_0x466792(0x191);if(!heatmap$1[_0x466792(0x177)]['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:_0x466792(0x1e0),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x433f67={}){var _0x3523b4={_0x51db70:0x1f3,_0x4aef2b:0x1b7,_0x503253:0x1a3},_0x15d16b=_0x466792;super(_0x433f67),this['options'][_0x15d16b(_0x3523b4._0x51db70)]=this['options']['redrawRatio']||0x1,this['options'][_0x15d16b(0x174)]={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this[_0x15d16b(_0x3523b4._0x4aef2b)][_0x15d16b(_0x3523b4._0x503253)]};}get[_0x466792(0x1d4)](){var _0xb8385e=_0x466792;return this[_0xb8385e(0x1f2)];}get['heatStyle'](){var _0x4c8390={_0x22bf79:0x174},_0x236c55=_0x466792;return this['options'][_0x236c55(_0x4c8390._0x22bf79)];}set['heatStyle'](_0xf24508){var _0x137bec={_0x4ce766:0x1b7},_0x31e52b=_0x466792;this[_0x31e52b(0x1b7)]['heatStyle']=mars3d__namespace['Util']['merge'](this[_0x31e52b(0x1b7)][_0x31e52b(0x174)],_0xf24508);if(this['_heat']){this[_0x31e52b(0x1cf)]['configure'](this[_0x31e52b(_0x137bec._0x4ce766)]['heatStyle']);const _0x2f26f2=this['_heat']['_renderer']['canvas']['toDataURL'](_0x31e52b(0x1c5),0x1);this['_updateGraphic'](_0x2f26f2);}}get['style'](){return this['options']['style'];}set['style'](_0x249c51){this['options']['style']=mars3d__namespace['Util']['merge'](this['options']['style'],_0x249c51);}get['positions'](){var _0x2d37c9=_0x466792;return this[_0x2d37c9(0x178)];}set['positions'](_0x2076d7){this['setPositions'](_0x2076d7);}get['coordinates'](){var _0x3ddfde=_0x466792;const _0x437861=[];return this[_0x3ddfde(0x1fa)][_0x3ddfde(0x1b4)](_0x5c6d42=>{_0x437861['push'](_0x5c6d42['toArray']());}),_0x437861;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x14b82a,_0x1449ee){_0x14b82a['positions']&&(this['positions']=_0x14b82a['positions']);}['_mountedHook'](){var _0x36aae2={_0x2c34df:0x1f2},_0x10a65b=_0x466792;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':_0x10a65b(0x1df),'private':!![]}):this[_0x10a65b(_0x36aae2._0x2c34df)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){var _0x3e80e4={_0x41edd9:0x1fe},_0x2a6000=_0x466792;this['_map'][_0x2a6000(0x1e7)](this['_layer']),this['_container']=mars3d__namespace['DomUtil'][_0x2a6000(0x17c)]('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this['options']['redrawZoom']&&(this[_0x2a6000(_0x3e80e4._0x41edd9)]['on'](mars3d__namespace['EventType']['cameraMoveEnd'],this[_0x2a6000(0x18d)],this),this[_0x2a6000(0x18d)]()),this['options']['flyTo']&&this['flyTo']();}['_removedHook'](){var _0x526c06={_0x41574e:0x18d},_0x1c2c60=_0x466792;this['options']['redrawZoom']&&this['_map']['off'](mars3d__namespace['EventType']['cameraMoveEnd'],this[_0x1c2c60(_0x526c06._0x41574e)],this),this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this[_0x1c2c60(0x1f2)]);}[_0x466792(0x184)](_0x5a6fc1){_0x5a6fc1&&this['_updatePositionsHook']();}[_0x466792(0x1ef)](_0x454280){this['_positions']=this['_positions']||[],this['_positions']['push'](_0x454280),this['_updatePositionsHook']();}['setPositions'](_0x3f8984){var _0x4084d0={_0x223bcc:0x178},_0xc8400=_0x466792;this[_0xc8400(_0x4084d0._0x223bcc)]=_0x3f8984,this['_updatePositionsHook']();}[_0x466792(0x201)](){var _0x4ec321={_0x185a52:0x1b6,_0x42baa8:0x1ad},_0x142b89=_0x466792;this['_graphic']&&(this['_layer'][_0x142b89(_0x4ec321._0x185a52)](this[_0x142b89(0x1f8)],!![]),delete this['_graphic']),this[_0x142b89(_0x4ec321._0x42baa8)]&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](){var _0x156a26={_0x427d9e:0x19e},_0x461f35=_0x466792;if(!this[_0x461f35(_0x156a26._0x427d9e)]||!this['_map']||!this[_0x461f35(0x1de)]||this['positions']['length']===0x0)return this;const _0x4a5aa8=this['_getHeatCanvas']();return this['_updateGraphic'](_0x4a5aa8),this;}[_0x466792(0x206)](_0xc11db7){var _0x1985aa={_0x324acc:0x1aa,_0x166925:0x1ee},_0x56c383=_0x466792;return _0xc11db7!==null&&_0xc11db7!==void 0x0&&_0xc11db7['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil'][_0x56c383(_0x1985aa._0x324acc)](this[_0x56c383(_0x1985aa._0x166925)]):this[_0x56c383(0x1ee)];}['_onCameraMoveEnd'](){var _0x44198a={_0x2acc9a:0x1fe,_0x1afa33:0x1b1,_0x45a43e:0x174,_0x3e0c02:0x212,_0x28b3d2:0x174},_0x3abb5f=_0x466792;if(!this['_heat']||!this['show']||!this['_map'])return;let _0x171546;const _0x3a03df=getSurfaceDistance(this[_0x3abb5f(_0x44198a._0x2acc9a)]['scene'])/0x2;if(_0x3a03df&&_0x3a03df<this[_0x3abb5f(_0x44198a._0x1afa33)]['radius']){const _0x45d3b7=this[_0x3abb5f(0x1b7)]['redrawRatio']*_0x3a03df/this['_bounds']['radius'];_0x171546=this[_0x3abb5f(_0x44198a._0x45a43e)]['radius']*_0x45d3b7,_0x171546=Math[_0x3abb5f(_0x44198a._0x3e0c02)](_0x171546,0x2);}else _0x171546=this[_0x3abb5f(_0x44198a._0x28b3d2)][_0x3abb5f(0x20d)];_0x171546&&this['updateRadius'](_0x171546);}['_getBounds'](_0x51fb29){var _0x26c488={_0x29292e:0x1b7,_0x17f282:0x203,_0x1775b3:0x17a,_0x3f9c5b:0x1a1,_0x2056cb:0x203,_0x2e9e5b:0x202,_0x5d59e6:0x197,_0x362d94:0x1eb,_0x15f9da:0x1fe},_0x2c8f1a=_0x466792;let _0x3e3cd8,_0x189603,_0x29047c,_0x34dd37;this[_0x2c8f1a(0x1b7)][_0x2c8f1a(0x203)]?(_0x3e3cd8=this[_0x2c8f1a(_0x26c488._0x29292e)]['rectangle']['xmin'],_0x189603=this['options']['rectangle']['xmax'],_0x29047c=this[_0x2c8f1a(0x1b7)]['rectangle']['ymin'],_0x34dd37=this['options'][_0x2c8f1a(_0x26c488._0x17f282)][_0x2c8f1a(_0x26c488._0x1775b3)]):_0x51fb29['forEach']((_0x37fdfd,_0x34a897)=>{var _0x1b8191=_0x2c8f1a;_0x34a897===0x0?(_0x3e3cd8=_0x37fdfd['lng'],_0x189603=_0x37fdfd['lng'],_0x29047c=_0x37fdfd['lat'],_0x34dd37=_0x37fdfd[_0x1b8191(0x17f)]):(_0x3e3cd8=Math['min'](_0x3e3cd8,_0x37fdfd['lng']),_0x189603=Math['max'](_0x189603,_0x37fdfd['lng']),_0x29047c=Math['min'](_0x29047c,_0x37fdfd['lat']),_0x34dd37=Math[_0x1b8191(0x212)](_0x34dd37,_0x37fdfd['lat']));});let _0x2e8140=_0x189603-_0x3e3cd8,_0x56c4c9=_0x34dd37-_0x29047c;_0x2e8140===0x0&&(_0x2e8140=0x1);_0x56c4c9===0x0&&(_0x56c4c9=0x1);const _0x2c046e=this['options']['rectanglePadding']??0.2;!this['options']['rectangle']&&(_0x3e3cd8-=_0x2e8140*_0x2c046e,_0x29047c-=_0x56c4c9*_0x2c046e,_0x189603+=_0x2e8140*_0x2c046e,_0x34dd37+=_0x56c4c9*_0x2c046e);_0x3e3cd8=Math['max'](_0x3e3cd8,-0xb4),_0x189603=Math['min'](_0x189603,0xb4),_0x29047c=Math['max'](_0x29047c,-0x5a),_0x34dd37=Math[_0x2c8f1a(_0x26c488._0x3f9c5b)](_0x34dd37,0x5a);const _0x4ba456={'xmin':_0x3e3cd8,'xmax':_0x189603,'ymin':_0x29047c,'ymax':_0x34dd37};_0x4ba456[_0x2c8f1a(0x20a)]=_0x189603-_0x3e3cd8,_0x4ba456['diffY']=_0x34dd37-_0x29047c,_0x4ba456['rectangle']=Cesium[_0x2c8f1a(0x1d0)]['fromDegrees'](_0x3e3cd8,_0x29047c,_0x189603,_0x34dd37);const _0x194b53=Math['max'](_0x4ba456[_0x2c8f1a(_0x26c488._0x2056cb)]['height'],_0x4ba456[_0x2c8f1a(_0x26c488._0x17f282)][_0x2c8f1a(_0x26c488._0x2e9e5b)]);return _0x4ba456['granularity']=_0x194b53,_0x4ba456['radius']=Cesium[_0x2c8f1a(_0x26c488._0x5d59e6)][_0x2c8f1a(_0x26c488._0x362d94)](_0x194b53,this[_0x2c8f1a(_0x26c488._0x15f9da)]['scene']['globe']['ellipsoid']['maximumRadius'])/(0x1+0x2*_0x2c046e),_0x4ba456;}['_getHeatCanvas'](){var _0x17b676={_0x367137:0x1b1,_0x1b568c:0x1b1,_0xa52623:0x1c6,_0x2e84f6:0x187,_0x367e39:0x1a3,_0xafa8d6:0x1b2,_0x19f4d9:0x1a1,_0x1cfe02:0x1b7,_0xcaeac3:0x1d3,_0x2c9d09:0x1d1},_0x1fc14e={_0x562a09:0x1db,_0x2ae359:0x1b3},_0x1f8f10={_0x9e95f6:0x17b,_0x2e9af9:0x1b3,_0x1ec882:0x1e9},_0x1bc88b=_0x466792;const _0x2c9254=this['_positions'],_0x11454a=[];_0x2c9254['forEach'](_0x4a29f4=>{var _0x5749aa=_0x42de;const _0x5d8de0=mars3d__namespace[_0x5749aa(_0x1f8f10._0x9e95f6)]['parse'](_0x4a29f4);if(!_0x5d8de0)return;_0x5d8de0['value']=_0x4a29f4[_0x5749aa(_0x1f8f10._0x2e9af9)]??0x1,_0x11454a[_0x5749aa(_0x1f8f10._0x1ec882)](_0x5d8de0);}),this['_bounds']=this['_getBounds'](_0x11454a),this['_rectangle']=this[_0x1bc88b(_0x17b676._0x367137)]['rectangle'];let _0xd0c5c7,_0x2de92d;this['_bounds'][_0x1bc88b(0x20a)]>this[_0x1bc88b(_0x17b676._0x1b568c)]['diffY']?(_0xd0c5c7=this['options']['canvasSize']??document['body']['clientWidth'],_0x2de92d=mars3d__namespace[_0x1bc88b(0x187)]['formatNum'](_0xd0c5c7/this[_0x1bc88b(_0x17b676._0x367137)]['diffX']*this['_bounds']['diffY'])):(_0x2de92d=this[_0x1bc88b(0x1b7)]['canvasSize']??document['body'][_0x1bc88b(_0x17b676._0xa52623)],_0xd0c5c7=mars3d__namespace[_0x1bc88b(_0x17b676._0x2e84f6)][_0x1bc88b(0x188)](_0x2de92d/this['_bounds'][_0x1bc88b(0x204)]*this['_bounds']['diffX']));this['_canvasWidth']=_0xd0c5c7,this['_canvasHeight']=_0x2de92d,this['_container'][_0x1bc88b(_0x17b676._0x367e39)][_0x1bc88b(_0x17b676._0xafa8d6)]=_0x1bc88b(0x20f)+_0xd0c5c7+'px;height:'+_0x2de92d+'px;display:none;';const _0xf93554={...this[_0x1bc88b(0x174)],'container':this['_container']};this['_heat']?this['_heat']['configure'](_0xf93554):this['_heat']=heatmap$1['exports'][_0x1bc88b(0x17c)](_0xf93554);let _0x2fa760=_0x11454a[0x0]['value']??0x1,_0x11a21f=_0x11454a[0x0]['value']??0x0;const _0x2ae776=[];_0x11454a['forEach'](_0x271bac=>{var _0x1098cc=_0x1bc88b;const _0x1057c7=Math['round']((_0x271bac[_0x1098cc(_0x1fc14e._0x562a09)]-this['_bounds']['xmin'])/this['_bounds']['diffX']*_0xd0c5c7),_0x1dbb6f=Math['round']((this['_bounds']['ymax']-_0x271bac['lat'])/this['_bounds']['diffY']*_0x2de92d),_0x404bfa=_0x271bac[_0x1098cc(_0x1fc14e._0x2ae359)]||0x1;_0x2fa760=Math['max'](_0x2fa760,_0x404bfa),_0x11a21f=Math['min'](_0x11a21f,_0x404bfa),_0x2ae776['push']({'x':_0x1057c7,'y':_0x1dbb6f,'value':_0x404bfa});});const _0x5a57a={'min':this['options'][_0x1bc88b(_0x17b676._0x19f4d9)]??_0x11a21f,'max':this[_0x1bc88b(_0x17b676._0x1cfe02)]['max']??_0x2fa760,'data':_0x2ae776};this['_heat'][_0x1bc88b(_0x17b676._0xcaeac3)](_0x5a57a);const _0x350b20=this['_heat']['_renderer']['canvas'][_0x1bc88b(_0x17b676._0x2c9d09)]('image/png',0x1);return _0x350b20;}['_getArcHeatCanvas'](){var _0x39691a={_0x50ce08:0x174,_0x44d207:0x1f1},_0x44169d=_0x466792;this['_heat']['configure']({'radius':this[_0x44169d(0x174)]['radius']*this['style']['arcRadiusScale'],'blur':this[_0x44169d(0x174)]['blur']*this[_0x44169d(0x1a3)]['arcBlurScale'],'gradient':this[_0x44169d(_0x39691a._0x50ce08)]['gradientArc']||{0.25:_0x44169d(_0x39691a._0x44d207),0.55:_0x44169d(0x193),0.85:_0x44169d(0x18a),0x1:_0x44169d(0x172)}});const _0x168fe2=this['_heat'][_0x44169d(0x1b5)]['canvas']['toDataURL']('image/png',0x1);return this[_0x44169d(0x1cf)]['configure'](this['options']['heatStyle']),_0x168fe2;}[_0x466792(0x1b9)](_0x16baf6){var _0x564c8a={_0x230e8e:0x1cf},_0x3d2543=_0x466792;const _0x547631=this['_heat']['getData']();if(_0x547631!==null&&_0x547631!==void 0x0&&_0x547631['data'])for(const _0x2a2138 in _0x547631['data']){const _0x1da487=_0x547631['data'][_0x2a2138];_0x1da487['radius']=_0x16baf6;}this['_heat']['setData'](_0x547631);const _0x5c005f=this[_0x3d2543(_0x564c8a._0x230e8e)][_0x3d2543(0x1b5)][_0x3d2543(0x1ab)]['toDataURL']('image/png',0x1);this[_0x3d2543(0x180)](_0x5c005f);}['getPointData'](_0x32c81c){var _0x22396e={_0x481395:0x1b1,_0x5146f6:0x1db,_0x1a6e23:0x17f,_0x5090d9:0x17a,_0x51d537:0x19b,_0x2f9de0:0x1b1,_0x3df9ad:0x1f9,_0x167cec:0x1cf,_0x94355a:0x1a4},_0x1592e4=_0x466792;const _0x5dc741=mars3d__namespace['LngLatPoint']['parse'](_0x32c81c);if(!_0x5dc741||!this[_0x1592e4(_0x22396e._0x481395)])return{};if(_0x5dc741[_0x1592e4(_0x22396e._0x5146f6)]<this['_bounds']['xmin']||_0x5dc741['lng']>this[_0x1592e4(_0x22396e._0x481395)][_0x1592e4(0x19b)]||_0x5dc741[_0x1592e4(_0x22396e._0x1a6e23)]<this['_bounds']['ymin']||_0x5dc741['lat']>this['_bounds'][_0x1592e4(_0x22396e._0x5090d9)])return{};const _0x5c60de=(_0x5dc741['lng']-this['_bounds']['xmin'])/(this['_bounds'][_0x1592e4(_0x22396e._0x51d537)]-this[_0x1592e4(0x1b1)]['xmin'])*this['_canvasWidth'],_0x46b753=(this['_bounds'][_0x1592e4(0x17a)]-_0x5dc741['lat'])/(this['_bounds']['ymax']-this[_0x1592e4(_0x22396e._0x2f9de0)][_0x1592e4(_0x22396e._0x3df9ad)])*this['_canvasHeight'],_0x4f32ee=this[_0x1592e4(_0x22396e._0x167cec)]['getValueAt']({'x':_0x5c60de,'y':_0x46b753}),_0x2384d5=this['_heat']['_renderer'][_0x1592e4(_0x22396e._0x94355a)]['getImageData'](_0x5c60de-0x1,_0x46b753-0x1,0x1,0x1)['data'];return{'x':_0x5c60de,'y':_0x46b753,'value':_0x4f32ee,'color':'rgba('+_0x2384d5[0x0]+','+_0x2384d5[0x1]+','+_0x2384d5[0x2]+','+_0x2384d5[0x3]+')'};}['_updateGraphic'](_0x40929a){var _0x562110={_0x372bd5:0x213,_0x43fabb:0x203,_0xdfa62f:0x1f8,_0x1a351f:0x1c3,_0x25005f:0x1c3,_0x404be9:0x1d6},_0x1a627c=_0x466792;if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x40929a,'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this[_0x1a627c(0x1a3)][_0x1a627c(_0x562110._0x372bd5)]?this['_graphic']&&this['_graphic'][_0x1a627c(_0x562110._0x43fabb)][_0x1a627c(0x18e)](this['_rectangle'])?(this[_0x1a627c(_0x562110._0xdfa62f)]['uniforms']['image']=_0x40929a,this['_graphic'][_0x1a627c(_0x562110._0x1a351f)]['bumpMap']=this[_0x1a627c(0x1b8)](),this[_0x1a627c(0x1ad)]&&(this['_graphic2'][_0x1a627c(_0x562110._0x1a351f)]['image']=_0x40929a,this['_graphic2']['uniforms']['bumpMap']=this['_graphic'][_0x1a627c(_0x562110._0x25005f)]['bumpMap'])):this[_0x1a627c(_0x562110._0x404be9)](_0x40929a):this['_graphic']&&this['_graphic']['rectangle'][_0x1a627c(0x18e)](this['_rectangle'])?this['_graphic']['uniforms']['image']=_0x40929a:this['_createGraphic'](_0x40929a);}['_createGraphic'](_0x4c1920){var _0x1c6042={_0x2e8ff1:0x20e},_0x4c7be7=_0x466792;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x4c7be7(0x186))]({...this[_0x4c7be7(0x1b7)],'private':!![],'flyTo':![],'rectangle':this[_0x4c7be7(0x1ee)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':mars3d__namespace['MaterialUtil']['createMaterial'](mars3d__namespace['MaterialType'][_0x4c7be7(_0x1c6042._0x2e8ff1)],{'image':_0x4c1920}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x401080){var _0x1710c4={_0x6993a0:0x201,_0x2aae01:0x195,_0x3a7a75:0x209,_0xe9e407:0x1a3,_0x2375b5:0x189,_0x5539a6:0x1b8,_0x1de260:0x1da,_0x4142d8:0x1ee,_0x1f53b2:0x1f2},_0x24536d=_0x466792;this[_0x24536d(_0x1710c4._0x6993a0)]();const _0x27a6b2=Cesium[_0x24536d(0x1e8)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x24536d(0x1a9)],'zPass':Cesium['StencilOperation'][_0x24536d(_0x1710c4._0x2aae01)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x24536d(_0x1710c4._0x3a7a75)]}),_0x91cb10=Math[_0x24536d(0x1f7)](this[_0x24536d(_0x1710c4._0xe9e407)]['diffHeight']??this['_bounds'][_0x24536d(0x20d)]*0.05)+0.1;this['style'][_0x24536d(_0x1710c4._0x2375b5)]&&delete this['style']['diffHeight'];this['style']['granularity']=this['_bounds']['granularity']/(this['style']['splitNum'],0x64);const _0x3dca2e=new Cesium[(_0x24536d(0x173))]({'fabric':{'uniforms':{'image':_0x401080,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x24536d(_0x1710c4._0x5539a6)]()},'source':HeatMaterial},'translucent':!![]}),_0x471b99=this['style'][_0x24536d(_0x1710c4._0x1de260)]||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'private':!![],'flyTo':![],'rectangle':this[_0x24536d(_0x1710c4._0x4142d8)],'appearance':new Cesium[(_0x24536d(0x185))]({'flat':!![],'aboveGround':!![],'renderState':_0x27a6b2,'material':_0x3dca2e,'vertexShaderSource':getVertexShaderSource(_0x91cb10*_0x471b99)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x24536d(_0x1710c4._0xe9e407)]['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'private':!![],'flyTo':![],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x27a6b2,'material':_0x3dca2e,'vertexShaderSource':getVertexShaderSource(-_0x91cb10)})}),this[_0x24536d(_0x1710c4._0x1f53b2)]['addGraphic'](this['_graphic2']));}}mars3d__namespace['LayerUtil']['register'](_0x466792(0x1bf),HeatLayer),mars3d__namespace[_0x466792(0x1d4)]['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337;function getVertexShaderSource(_0x1e8667){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x1e8667+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}function getSurfaceDistance(_0x2be5c5){var _0x44c14d={_0x2343b7:0x207,_0x45ce2d:0x1d9,_0x4444ea:0x179},_0x1b0d7a=_0x466792;const _0xaeaf88=_0x2be5c5['globe'][_0x1b0d7a(_0x44c14d._0x2343b7)],_0x3de88a=_0x2be5c5[_0x1b0d7a(0x1ab)],_0x26c9d5=_0x3de88a['clientWidth']/0x2,_0x3deaa5=_0x3de88a['clientHeight']/0x2,_0x1e8800=_0x3de88a['clientWidth']/0x64,_0x3d4c2c=new Cesium[(_0x1b0d7a(_0x44c14d._0x45ce2d))](_0x26c9d5,_0x3deaa5);let _0x3d9d49,_0x1fc6cd;_0x3d4c2c['x']=_0x26c9d5;for(let _0x5dd951=0x0;_0x5dd951<0x64;_0x5dd951++){_0x3d4c2c['y']=_0x1e8800*_0x5dd951;const _0x45c723=_0x2be5c5['camera']['pickEllipsoid'](_0x3d4c2c,_0xaeaf88);if(_0x45c723){_0x3d9d49=_0x45c723;break;}}for(let _0x4ccfaa=0x64;_0x4ccfaa>0x0;_0x4ccfaa--){_0x3d4c2c['y']=_0x1e8800*_0x4ccfaa;const _0xebcda6=_0x2be5c5['camera'][_0x1b0d7a(_0x44c14d._0x4444ea)](_0x3d4c2c,_0xaeaf88);if(_0xebcda6){_0x1fc6cd=_0xebcda6;break;}}return _0x3d9d49&&_0x1fc6cd?mars3d__namespace['MeasureUtil']['getSurfaceDistance']([_0x3d9d49,_0x1fc6cd]):0x0;}exports['HeatLayer']=HeatLayer,Object[_0x466792(0x1dc)](exports,'__esModule',{'value':!![]});
}));
